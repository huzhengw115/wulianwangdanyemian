angular.module("starter",["ionic","starter.controllers","starter.services"]).run(["$ionicPlatform",function(e){e.ready(function(){window.cordova&&window.cordova.plugins&&window.cordova.plugins.Keyboard&&(cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),cordova.plugins.Keyboard.disableScroll(!0)),window.StatusBar&&StatusBar.styleDefault()})}]).config(["$stateProvider","$urlRouterProvider",function(e,o){e.state("tab",{url:"/tab",abstract:!0,templateUrl:"templates/tabs.html"}).state("tab.news",{url:"/news",views:{News:{templateUrl:"templates/news.html",controller:"NewsCtrl"}}}).state("tab.project",{url:"/project",views:{Project:{templateUrl:"templates/project.html",controller:"ProjectCtrl"}}}),o.otherwise("/tab/news")}]).directive("hideTabs",["$rootScope",function(e){return{restrict:"A",link:function(o,t,n){o.$on("$ionicView.beforeEnter",function(){o.$watch(n.hideTabs,function(o){e.hideTabs=o})}),o.$on("$ionicView.beforeLeave",function(){e.hideTabs=!1})}}}]).service("swipeService",["$document",function(e){var o=function(){function o(e,o){return function(){if(e.naturalWidth>250){var r={src:e.src,w:e.naturalWidth,h:e.naturalHeight};n.push(r),angular.element(e).bind("click",t(o))}}}function t(e){return function(){console.log("bindImg: [index, items]",e,n),i.index=e;var o=new PhotoSwipe(r,PhotoSwipeUI_Default,n,i);o.init(),o.goTo(e)}}var n=[],r=document.querySelectorAll(".pswp")[0],i={index:0,shareEl:!1,tapToClose:!0},a=angular.element(e.find("main"));a.ready(function(){var e=a.find("img");console.log("imgs:",e);for(var t=0;t<e.length;++t){var n=e[t];0==n.naturalWidth&&0==n.naturalHeight?angular.element(n).bind("load",o(n,t)):o(n,t)()}})};return{photoswipe:o}}]),angular.module("starter.controllers",[]).controller("NewsCtrl",["$scope","newsService","swipeService","LoaderService",function(e,o,t,n){var r=function(){n.show(),o.getNewsData().then(function(o){e.newsData=o,console.log("$scope.newsData:",e.newsData),t.photoswipe(),""==e.newsData.pic?e.isPicShow=!1:e.isPicShow=!0}),n.hide()};r()}]).controller("ProjectCtrl",["$scope","newsService","swipeService","LoaderService",function(e,o,t,n){e.projectData=[],e.openButton=!0;var r=function(){n.show(),o.getProjectData().then(function(o){e.projectData=o,console.log("$scope.projectData:",e.projectData),t.photoswipe()}),n.hide()};e.showTable=function(o){e.isShow=!0,e.tableShow=o,console.log(e.tableShow)},e.hideTable=function(){e.isShow=!1},e.toBeLong=function(){e.projectTable=!e.projectTable,e.openButton=!e.openButton,e.closeButton=!e.closeButton},r()}]),angular.module("starter.services",[]).service("newsService",["$http","$q",function(e,o){var t=function(){var t=[],n=o.defer();return e.get("json/news.json").success(function(e){t=e,n.resolve(t)}).error(function(){console.log("读取资讯失败"),n.reject()}),n.promise},n=function(){var t=[],n=o.defer();return e.get("json/project.json").success(function(e){t=e,n.resolve(t)}).error(function(){console.log("读取方案失败"),n.reject()}),n.promise};return{getNewsData:t,getProjectData:n}}]).factory("LoaderService",["$rootScope","$ionicLoading",function(e,o){return{show:function(){e.loading=o.show({template:"<i>加载中...</i>",animation:"fade-in",showBackdrop:!0,minWidth:200,showDelay:10})},hide:function(){o.hide()}}}]);